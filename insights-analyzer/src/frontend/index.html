<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Seinsight AI - An√°lise de Mercado Web3</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #333;
      line-height: 1.6;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    .header {
      text-align: center;
      margin-bottom: 3rem;
      color: white;
    }

    .header h1 {
      font-size: 3rem;
      font-weight: 700;
      margin-bottom: 1rem;
      background: linear-gradient(45deg, #fff, #f0f0f0);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .header p {
      font-size: 1.2rem;
      opacity: 0.9;
      font-weight: 300;
    }

    .main-content {
      background: white;
      border-radius: 20px;
      padding: 3rem;
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
      backdrop-filter: blur(10px);
    }

    .input-section {
      margin-bottom: 3rem;
    }

    .input-section h2 {
      font-size: 1.8rem;
      margin-bottom: 1rem;
      color: #2d3748;
      font-weight: 600;
    }

    .input-section p {
      color: #718096;
      margin-bottom: 2rem;
      font-size: 1.1rem;
    }

    .form-group {
      margin-bottom: 2rem;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
      color: #2d3748;
    }

    .form-group textarea {
      width: 100%;
      min-height: 120px;
      padding: 1rem;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      font-family: inherit;
      font-size: 1rem;
      resize: vertical;
      transition: all 0.3s ease;
    }

    .form-group textarea:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .submit-btn {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      padding: 1rem 2rem;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
    }

    .submit-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }

    .loading {
      display: none;
      text-align: center;
      padding: 2rem;
    }

    .loading.show {
      display: block;
    }

    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 1rem;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    .results-section {
      display: none;
    }

    .results-section.show {
      display: block;
    }

    .results-section h2 {
      font-size: 1.8rem;
      margin-bottom: 2rem;
      color: #2d3748;
      font-weight: 600;
    }

    .result-card {
      background: #f7fafc;
      border-radius: 16px;
      padding: 2rem;
      margin-bottom: 2rem;
      border-left: 4px solid #667eea;
    }

    .result-card h3 {
      font-size: 1.3rem;
      margin-bottom: 1rem;
      color: #2d3748;
      font-weight: 600;
    }

    .hashtags {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .hashtag {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 500;
    }

    .analysis-content {
      background: white;
      border-radius: 12px;
      padding: 1.5rem;
      border: 1px solid #e2e8f0;
    }

    .analysis-content h4 {
      font-size: 1.1rem;
      margin-bottom: 1rem;
      color: #2d3748;
      font-weight: 600;
    }

    .analysis-content ul {
      list-style: none;
      padding-left: 0;
    }

    .analysis-content li {
      padding: 0.5rem 0;
      border-bottom: 1px solid #f1f5f9;
      position: relative;
      padding-left: 1.5rem;
    }

    .analysis-content li:before {
      content: "‚Ä¢";
      color: #667eea;
      font-weight: bold;
      position: absolute;
      left: 0;
    }

    .analysis-content li:last-child {
      border-bottom: none;
    }

    .error {
      background: #fed7d7;
      color: #c53030;
      padding: 1rem;
      border-radius: 12px;
      border: 1px solid #feb2b2;
      margin-bottom: 1rem;
    }

    .success {
      background: #c6f6d5;
      color: #22543d;
      padding: 1rem;
      border-radius: 12px;
      border: 1px solid #9ae6b4;
      margin-bottom: 1rem;
    }

    @media (max-width: 768px) {
      .container {
        padding: 1rem;
      }

      .main-content {
        padding: 2rem;
      }

      .header h1 {
        font-size: 2rem;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>Seinsight AI</h1>
      <p>An√°lise inteligente de mercado para empreendedores Web3</p>
    </div>

    <div class="main-content">
      <div class="input-section">
        <h2>Descreva seu neg√≥cio</h2>
        <p>Conte-nos sobre sua ideia ou neg√≥cio para que possamos analisar o mercado e fornecer insights
          valiosos da comunidade Web3.</p>

        <form id="analysisForm">
          <div class="form-group">
            <label for="businessDescription">Descri√ß√£o do seu neg√≥cio ou ideia:</label>
            <textarea id="businessDescription"
              placeholder="Ex: Preciso avaliar no mercado os interesses por verifica√ß√£o de media e conte√∫do na blockchain, tamb√©m sobre a necessidade de comprova√ß√£o e valida√ß√£o de media como autenticas e n√£o geradas por IA..."
              required></textarea>
          </div>

          <button type="submit" class="submit-btn" id="submitBtn">
            <span>üîç Analisar Mercado</span>
          </button>
        </form>
      </div>

      <div class="loading" id="loading">
        <div class="spinner"></div>
        <p>Analisando mercado e gerando insights...</p>
        <p style="font-size: 0.9rem; color: #718096; margin-top: 0.5rem;">Isso pode levar alguns segundos</p>
      </div>

      <div class="results-section" id="resultsSection">
        <h2>üìä An√°lise de Mercado Completa</h2>

        <div class="result-card">
          <h3>üè∑Ô∏è Hashtags Geradas</h3>
          <div class="hashtags" id="hashtagsContainer"></div>
        </div>

        <div class="result-card">
          <h3>üß† An√°lise Cr√≠tica da IA</h3>
          <div class="analysis-content" id="analysisContent"></div>
        </div>
      </div>
    </div>
  </div>

  <script>
    class SeinsightAI {
      constructor() {
        this.form = document.getElementById('analysisForm');
        this.submitBtn = document.getElementById('submitBtn');
        this.loading = document.getElementById('loading');
        this.resultsSection = document.getElementById('resultsSection');
        this.hashtagsContainer = document.getElementById('hashtagsContainer');
        this.analysisContent = document.getElementById('analysisContent');

        // ElizaOS API endpoints
        this.elizaosUrl = 'http://localhost:3000';
        this.hashtagGeneratorId = '635b4207-35ce-0ec5-a517-52445ae58215';
        this.insightCompilerId = '3643e20d-b322-0e3e-a089-87f323dc94ad';
        this.userId = '550e8400-e29b-41d4-a716-446655440000';

        this.init();
      }

      init() {
        this.form.addEventListener('submit', (e) => this.handleSubmit(e));
      }

      async handleSubmit(e) {
        e.preventDefault();

        const businessDescription = document.getElementById('businessDescription').value.trim();
        if (!businessDescription) return;

        this.showLoading();
        this.hideResults();

        try {
          await this.performRealAnalysis(businessDescription);
        } catch (error) {
          this.showError('Erro ao realizar an√°lise. Tente novamente.');
          console.error('Analysis error:', error);
        } finally {
          this.hideLoading();
        }
      }

      async performRealAnalysis(businessDescription) {
        console.log('Starting REAL analysis for:', businessDescription);

        // Step 1: Generate hashtags using REAL ElizaOS HashtagGenerator
        const hashtags = await this.generateRealHashtags(businessDescription);

        // Step 2: Analyze market data using REAL ElizaOS InsightCompiler
        const analysis = await this.analyzeRealMarket(hashtags, businessDescription);

        // Step 3: Display results
        this.displayResults(hashtags, analysis);
      }

      async generateRealHashtags(businessDescription) {
        try {
          // Create session with HashtagGenerator
          const sessionResponse = await fetch(`${this.elizaosUrl}/api/messaging/sessions`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              agentId: this.hashtagGeneratorId,
              userId: this.userId,
              metadata: {
                platform: "frontend",
                purpose: "hashtag-generation"
              }
            })
          });

          if (!sessionResponse.ok) {
            throw new Error('Failed to create hashtag session');
          }

          const sessionData = await sessionResponse.json();
          const sessionId = sessionData.sessionId;

          // Send message to generate hashtags
          await fetch(`${this.elizaosUrl}/api/messaging/sessions/${sessionId}/messages`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              content: businessDescription,
              metadata: {
                requestType: "hashtag-generation"
              }
            })
          });

          // Wait for agent response
          await this.delay(20000);

          // Get messages from session
          const messagesResponse = await fetch(`${this.elizaosUrl}/api/messaging/sessions/${sessionId}/messages`);
          const messagesData = await messagesResponse.json();

          if (messagesData.messages) {
            const agentMessages = messagesData.messages.filter(msg => msg.isAgent);
            if (agentMessages.length > 0) {
              const agentResponse = agentMessages[agentMessages.length - 1].content;
              const hashtags = agentResponse.match(/#\w+/g) || [];

              // Clean up session
              await fetch(`${this.elizaosUrl}/api/messaging/sessions/${sessionId}`, {
                method: 'DELETE'
              });

              return hashtags;
            }
          }

          throw new Error('No hashtags generated');
        } catch (error) {
          console.error('Hashtag generation error:', error);
          throw error;
        }
      }

      async analyzeRealMarket(hashtags, businessDescription) {
        try {
          // Create session with InsightCompiler
          const sessionResponse = await fetch(`${this.elizaosUrl}/api/messaging/sessions`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              agentId: this.insightCompilerId,
              userId: this.userId,
              metadata: {
                platform: "frontend",
                purpose: "critical-analysis"
              }
            })
          });

          if (!sessionResponse.ok) {
            throw new Error('Failed to create analysis session');
          }

          const sessionData = await sessionResponse.json();
          const sessionId = sessionData.sessionId;

          // Send analysis request
          const analysisRequest = `Analyze this business idea for Web3 entrepreneurs with a critical and balanced perspective:

Hashtags: ${hashtags.join(', ')}
Business Context: ${businessDescription}

Please provide a critical analysis that includes:
1. Market risks and challenges
2. Potential obstacles and limitations
3. Competitive landscape considerations
4. Realistic opportunities (not overly optimistic)
5. Potential failure points to watch for
6. Balanced recommendations considering both opportunities and risks

Be objective, data-driven, and avoid overly positive bias. Focus on actionable insights that help entrepreneurs make informed decisions.`;

          await fetch(`${this.elizaosUrl}/api/messaging/sessions/${sessionId}/messages`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({
              content: analysisRequest,
              metadata: {
                requestType: "critical-analysis"
              }
            })
          });

          // Wait for analysis response
          await this.delay(25000);

          // Get analysis messages
          const messagesResponse = await fetch(`${this.elizaosUrl}/api/messaging/sessions/${sessionId}/messages`);
          const messagesData = await messagesResponse.json();

          if (messagesData.messages) {
            const agentMessages = messagesData.messages.filter(msg => msg.isAgent);
            if (agentMessages.length > 0) {
              const analysisResponse = agentMessages[agentMessages.length - 1].content;

              // Clean up session
              await fetch(`${this.elizaosUrl}/api/messaging/sessions/${sessionId}`, {
                method: 'DELETE'
              });

              return analysisResponse;
            }
          }

          throw new Error('No analysis response received');
        } catch (error) {
          console.error('Market analysis error:', error);
          throw error;
        }
      }

      displayResults(hashtags, analysis) {
        // Display hashtags
        this.hashtagsContainer.innerHTML = hashtags
          .map(hashtag => `<span class="hashtag">${hashtag}</span>`)
          .join('');

        // Display analysis
        this.analysisContent.innerHTML = `
          <div style="white-space: pre-wrap; line-height: 1.6;">${analysis}</div>
        `;

        this.showResults();
      }

      showLoading() {
        this.submitBtn.disabled = true;
        this.submitBtn.innerHTML = '<span>‚è≥ Analisando...</span>';
        this.loading.classList.add('show');
      }

      hideLoading() {
        this.submitBtn.disabled = false;
        this.submitBtn.innerHTML = '<span>üîç Analisar Mercado</span>';
        this.loading.classList.remove('show');
      }

      showResults() {
        this.resultsSection.classList.add('show');
        this.resultsSection.scrollIntoView({ behavior: 'smooth' });
      }

      hideResults() {
        this.resultsSection.classList.remove('show');
      }

      showError(message) {
        const errorDiv = document.createElement('div');
        errorDiv.className = 'error';
        errorDiv.textContent = message;
        this.form.insertBefore(errorDiv, this.form.firstChild);

        setTimeout(() => {
          errorDiv.remove();
        }, 5000);
      }

      delay(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
      }
    }

    // Initialize the application
    document.addEventListener('DOMContentLoaded', () => {
      new SeinsightAI();
    });
  </script>
</body>

</html>